<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BuildVu Client</title>
    <script src="buildvu-client.js" type="text/javascript"></script>
</head>
<body>

<input id="file" type="file" />
<input id="submit" type="submit" value="Process File" />
<input id="clear" type="button" value="Clear" />
<div id="consoleDiv" style="font-family: 'Courier New', Courier, monospace"></div>


<script type="text/javascript">

    var outputDiv = document.getElementById("consoleDiv");

    document.getElementById("clear").addEventListener('click', function() {
        outputDiv.innerText = "";
    });

    function writeMessage(message) {
        outputDiv.innerText = outputDiv.innerText + "\n" + message;
        console.log(message);
    }


    function progressListener(e) {
        writeMessage(JSON.stringify(e));
    }

    function failureListener(e) {
        writeMessage(e);
    }

    function successListener(e) {
        writeMessage(JSON.stringify(e));
        writeMessage("\nConverted " + e.previewUrl + "\n\n");
    }
    
    var endpoint = "http://localhost:8080/microservice-example/buildvu";

    document.getElementById("submit").addEventListener('click', function() {
        var file = document.getElementById('file').files[0];
        if (file.name) {
            BuildVuClient.convert({
                endpoint: endpoint,
                file: file,
                progress: progressListener,
                success: successListener,
                failure: failureListener
            });
        }
    });

</script>

</body>
</html>